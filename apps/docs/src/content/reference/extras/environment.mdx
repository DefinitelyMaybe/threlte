---
order: 7.15
category: '@threlte/extras'
sourcePath: 'packages/extras/src/lib/components/environment/Environment.svelte'
name: <Environment>
type: 'component'
componentSignature:
  {
    props:
      [
        { description: 'the file to load', name: 'file', required: true, type: 'string' },
        {
          default: 'false',
          description: 'whether to set `scene.background` to the loaded environment texture',
          name: 'isBackground',
          required: false,
          type: 'boolean'
        },
        {
          default: 'useThrelte().scene',
          description: 'the scene that will have its environment and/or background set',
          name: 'scene',
          required: false,
          type: 'THREE.Scene'
        },
        {
          default: '(texture) => { texture.mapping = Three.EquirectangularReflectionMapping }',
          description: 'used to modify a texture after it is loaded but before it is assigned to `scene.environment`',
          name: 'ontextureloaded',
          required: false,
          type: '(texture: Three.Texture) => void'
        },
        {
          description: 'used to modify a loader after it is created',
          name: 'onloadercreated',
          required: false,
          type: '(loader: Three.EXRLoader | Three.RGBELoader | Three.TextureLoader) => void'
        }
      ]
  }
---

Asynchronously loads a single environment texture and sets the provided scene's `environment` and or `background` to the texture when loaded. Designed to handle equirectangular environment textures. [Here](/environment-maps/jpg/equirect_ruined_room.jpg) is an example of such a texture.

<Example path="extras/environment/basic" />

## Loading Different File Types

`<Environment>` supports loading `.exr`, `.hdr`, and any file type that can be loaded by ThreeJS's [TextureLoader](https://threejs.org/docs/#api/en/loaders/TextureLoader) such as `.jpg` files. This means you can swap the `file` prop at any time and `<Environment>` will dispose of the previous texture and assign the new one to the scene's `environment` and/or `background` properties. Loaders within `<Environment>` are created on demand and cached for future use until `<Environment>` unmounts.

<Tip type="info">
	`<Environment>` only holds onto one texture. Any time it has to load a new texture, it will dispose of the old one. The texture is also disposed when `<Environment>` unmounts.
</Tip>

Internally `<Environment>` creates a loader based on the extension of the `file` prop. Refer to the table below to determine what kind of loader is used for a particular file.

| file extension | loader                                                                                             |
| -------------- | -------------------------------------------------------------------------------------------------- |
| .exr           | [Three.EXRLoader](https://github.com/mrdoob/three.js/blob/dev/examples/jsm/loaders/EXRLoader.js/)  |
| .hdr           | [Three.RGBELoader](https://github.com/mrdoob/three.js/blob/dev/examples/jsm/loaders/RGBELoader.js) |
| all others     | [Three.TextureLoader](https://threejs.org/docs/#api/en/loaders/TextureLoader)                      |

As previously mentioned, `file` should at least be something that can be loaded by `Three.TextureLoader`.

## Modifying the Loaded Texture

`<Environment>` has an `ontextureloaded` prop that can be used to modify the texture **after** it has been loaded but **before** it is assigned to `scene.environment`. The default `ontextureloaded` function assigns `Three.EquirectangularReflectionMapping` to `texture.mapping` but you can do a variety of things with the texture. Check out the [textures section of the ThreeJS docs](https://threejs.org/manual/#en/textures) for some examples.

<Tip type="warning">
`ontextureloaded` is called in a `.then`. This means that if `ontextureloaded` is updated, it will not run again until the loader inside `<Environment>` must load a new texture. Loading a new texture is triggered by updating the `file` prop.
</Tip>

In the example below notice how toggling the checkbox does not cause the texture to flip. If you toggle the checkbox and then select a different file, the newly loaded texture will reflect the checkbox's state.

<Example path="extras/environment/modifying-the-texture" />

## Restoring Environment and Background When Scene Updates

All of `<Environment>`'s props are reactive, even `scene`. If the `scene` prop is updated, `<Environment>` will restore the initial `environment` and `background` properties of the last scene.

The example below creates a custom render task that draws two scenes to the canvas - one on the left and one on the right. Pressing the button switches the environment map to be applied to either the left or the right side. You can observe that when the side updates, the original `background` and `environment` for that side are restored.

<Example path="extras/environment/swapping-scenes" />

## Suspended Loading

Textures are suspended so they may be used in a suspense context. This means if you're fetching the file over a slow network, you can show something in the "fallback" snippet of a [\<Suspense>]('/docs/reference/extras/suspense') component.

```svelte
<script>
  import { Suspense, Text } from '@threlte/extras'
</script>

<Suspense>
  {#snippet fallback()}
    <Text text="loading environment" />
  {/snippet}
  <Environment
    file="https//url-of-your-file.hdr"
    onloadercreated={(loader) => {
      // set cross origin, credentials, etc for the created loader to be able to fetch `file`
      // loader.setCrossOrigin()
      // loader.setWithCredentials()
      // loader.setRequestHeader()
    }}
  />
</Suspense>
```
