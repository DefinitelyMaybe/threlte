---
{
  order: 3,
  category: '@threlte/extras',
  sourcePath: 'packages/extras/src/lib/components/InstancedSprite/Spritesheet.svelte',
  name: <Spritesheet>,
  type: 'component',
  componentSignature:
    {
      props:
        [
					{
            name: 'dataUrl',
            type: 'string',
            required: false,
            description: 'Url of a spritesheet json with metadata.'
          },
          {
            name: 'textureUrl',
            type: 'string',
            required: false,
            description: 'Url of a spritesheet image. This will get overwritten if you declare spritesheet meta with help of <File/> and <Animation/> child components.'
          },
					{
						name: 'aseprite',
						type: 'boolean',
						required: false,
						description: 'Set to true if you are using an Aseprite .json file in dataUrl.'
          },
					{
						name: 'filter',
						type: 'nearest | linear',
						default: 'nearest',
						required: false,
						description: 'The texture filtering applied to the spritesheet.'
          }
        ],
      events:
        [
          {
            name: 'load',
            payload: 'void',
            description: 'Fires when spritesheet metadata and texture have been fully created or loaded.'
          }
        ]
    }
}
---

<Tip type="experimental">Experimental warning. The api may change significantly, performance and compatiblity untested on various hardware/OS.</Tip>

**Utility component to declare or load a spritesheet for `<InstancedSprite>` component.**

## Spritesheet

Spritesheet declaration, two modes:
- `rowColumn` where `width` is number of columns and `height` number of rows
- `frameSize` where `width` is width and `height` is height of a **single frame in the spritesheet**

{/* I'll center it later, don't yell at me */}
Preview of row and column numbering (orange, outside) and frame numbering (blue, inside)
![Spritesheet row-column](/images/docs/extras/instanced-sprite/spritesheet-rowcol.png)

Animations are declared as a range of frameIds, for example the `attack` animation of the spritesheet above would look like this:
```svelte
<Spritesheet
  let:File
  let:Animation
>
  <File
    textureUrl="/textures/sprites/cacodaemon.png"
    options={{
      type: 'rowColumn',
      width: 8,
      height: 4
    }}
  >
    <Animation
      name="attack"
      frameRange={[8, 14]}
    />
  </File>
</Spritesheet>
```

**One spritesheet file with multiple animations**
<details>
	<summary>Preview sprite</summary>
	*cacodaemon.png*
	![Multi image spritesheet](/textures/sprites/cacodaemon.png)
</details>

```svelte
<Spritesheet
  let:File
  let:Animation
>
  <File
    textureUrl="/textures/sprites/cacodaemon.png"
    options={{
      type: 'rowColumn',
      width: 8,
      height: 4
    }}
  >
    <Animation
      name="fly"
      frameRange={[0, 6]}
    />
    <Animation
      name="attack"
      frameRange={[8, 14]}
    />
    <Animation
      name="idle"
      frameRange={[16, 20]}
    />
    <Animation
      name="defeated"
      frameRange={[24, 32]}
    />
  </File>

  <InstancedSprite/>
</Spritesheet>

```

**Combining multiple files with one animation per file**
<details>
	<summary>Preview sprites</summary>
	*Attack.png*
	![Goblin Attack sprite](/textures/sprites/goblin/Attack.png)
	*Idle.png*
	![Goblin Idle sprite](/textures/sprites/goblin/Idle.png)
	*Run.png*
	![Goblin Run sprite](/textures/sprites/goblin/Run.png)
	*TakeHit.png*
	![Goblin TakeHit sprite](/textures/sprites/goblin/TakeHit.png)
</details>


```svelte
<Spritesheet
  let:File
  let:Animation
>
  <File
    textureUrl="/textures/sprites/goblin/Attack.png"
    options={{
      type: 'rowColumn',
      width: 8,
      height: 1
    }}
  >
    <Animation
      name="attack"
      frameRange={[0, 8]}
    />
  </File>

  <File
    textureUrl="/textures/sprites/goblin/Death.png"
    options={{
      type: 'rowColumn',
      width: 4,
      height: 1
    }}
  >
    <Animation
      name="death"
      frameRange={[0, 4]}
    />
  </File>
  <File
    textureUrl="/textures/sprites/goblin/Idle.png"
    options={{
      type: 'rowColumn',
      width: 4,
      height: 1
    }}
  >
    <Animation
      name="idle"
      frameRange={[0, 4]}
    />
  </File>

  <File
    textureUrl="/textures/sprites/goblin/Run.png"
    options={{
      type: 'rowColumn',
      w: 8,
      height: 1
    }}
  >
    <Animation
      name="run"
      frameRange={[0, 4]}
    />
  </File>

  <File
    textureUrl="/textures/sprites/goblin/TakeHit.png"
    options={{
      type: 'rowColumn',
      width: 4,
      height: 1
    }}
  >
    <Animation
      name="takeHit"
      frameRange={[0, 4]}
    />
  </File>

  <InstancedSprite/>
</Spritesheet>
```

### Spritesheet format

```ts
type SpritesheetFormat = {
  frames: [x: number, y: number, width: number, height: number][];
  animations: Record<string, [frameId: number, duration: number][]>;
  sheetSize: [width: number, height: number][];
  animationLengths: number[];
};
```
